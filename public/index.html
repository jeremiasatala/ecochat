<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>EcoChat</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" type="image/x-icon" href="assets/ecochaticon.ico">
</head>
<body>
  <div class="layout">

    <!-- Sidebar izquierda: perfil siempre visible -->
    <aside class="sidebar-left sidebar">
      <div class="logo">
        <img src="assets/logo.png" alt="EcoChat" class="logo-img">
        <h2>EcoChat</h2>
      </div>

      <!-- Perfil de Invitado (siempre visible) -->
      <div id="profile">
        <div id="profile-card">
          <div class="cover-photo">
            <img id="coverPreview" src="assets/default-cover.png" alt="Portada">
          </div>

          <div class="avatar-container">
            <img id="avatarPreview" src="assets/default-avatar.png" alt="Avatar">
          </div>

          <div class="profile-info">
            <h3 id="usernameDisplay">Invitado</h3>
            <p id="bio">Bienvenido a EcoChat</p>
            <p class="stats">Mensajes enviados: <span id="messageCount">0</span></p>

            <!-- Redes sociales en el perfil propio -->
            <div id="social-links">
              <div id="instagram-link" class="social-link hidden">
                <span style="font-weight: bold;">📷</span>
                <a id="instagram-username" href="#" target="_blank" style="color: #6c757d; text-decoration: none; font-weight: bold;">@usuario</a>
              </div>
              <div id="twitter-link" class="social-link hidden">
                <span style="font-weight: bold;">🐦</span>
                <a id="twitter-username" href="#" target="_blank" style="color: #6c757d; text-decoration: none; font-weight: bold;">@usuario</a>
              </div>
            </div>
            
            <!-- Botones de auth (visibles cuando no logueado) -->
            <div id="auth-buttons">
              <button id="showLoginBtn" class="btn-modern btn-primary-modern">
                <span>🔑</span> Iniciar Sesión
              </button>
              <button id="showRegisterBtn" class="btn-modern btn-outline-modern" style="margin-top: 10px;">
                <span>📝</span> Registrarse
              </button>
            </div>
            
            <!-- Botones de perfil (ocultos hasta login) -->
            <div id="profile-actions" class="hidden">
              <button id="editProfileBtn" class="btn-modern btn-outline-modern">
                <span>✏️</span> Editar Perfil
              </button>
              <button id="logoutBtn" class="btn-modern btn-outline-modern" style="margin-top: 10px; background: #dc3545; border-color: #dc3545; color: white;">
                <span>🚪</span> Cerrar Sesión
              </button>
            </div>
          </div>
        </div>

        <!-- Formularios de auth (ocultos inicialmente) -->
        <div id="auth-forms" class="hidden">
          <!-- Registro -->
          <div class="form-section">
            <h3>Registrarse</h3>
            <div class="input-group-modern">
              <input id="registerUsername" type="text" class="input-modern" placeholder=" ">
              <label class="input-label">Nombre de usuario</label>
            </div>
            <!-- AÑADIR ESTO: Textarea para la descripción -->
            <div class="input-group-modern">
              <textarea id="editBio" name="bio" class="input-modern" placeholder=" " rows="3" style="resize: vertical;"></textarea>
              <label class="input-label">Descripción de perfil</label>
            </div>
            <div class="input-group-modern">
              <input id="registerEmail" type="email" class="input-modern" placeholder=" ">
              <label class="input-label">Email</label>
            </div>
            <div class="input-group-modern">
              <input id="registerPassword" type="password" class="input-modern" placeholder=" ">
              <label class="input-label">Contraseña</label>
            </div>
            <button id="registerBtn" class="btn-modern btn-primary-modern">
              <span>📝</span> Crear cuenta
            </button>
            <button id="cancelRegisterBtn" class="btn-modern btn-outline-modern" style="margin-top: 10px;">
              <span>↩️</span> Cancelar
            </button>
          </div>

          <div class="divider-modern">
            <span>o</span>
          </div>

          <!-- Login -->
          <div class="form-section">
            <h3>Iniciar sesión</h3>
            <div class="input-group-modern">
              <input id="loginEmail" type="email" class="input-modern" placeholder=" ">
              <label class="input-label">Email</label>
            </div>
            <div class="input-group-modern">
              <input id="loginPassword" type="password" class="input-modern" placeholder=" ">
              <label class="input-label">Contraseña</label>
            </div>
            <button id="loginBtn" class="btn-modern btn-secondary-modern">
              <span>🔑</span> Ingresar
            </button>
            <button id="cancelLoginBtn" class="btn-modern btn-outline-modern" style="margin-top: 10px;">
              <span>↩️</span> Cancelar
            </button>
          </div>
        </div>

        <!-- Edición de perfil (oculto hasta login) -->
        <div id="profile-edit" class="hidden">
          <div class="divider-modern">
            <span>Editar información</span>
          </div>

          <div class="form-section">
            <div class="input-group-modern">
              <input id="editUsername" type="text" class="input-modern" placeholder=" ">
              <label class="input-label">Nombre de usuario</label>
            </div>

            <button id="guardarUsernameBtn" class="btn-modern">
              <span>💾</span> Guardar Nombre de Usuario
            </button>


            <div class="input-group-modern">
              <textarea id="editBioInput" class="input-modern" placeholder=" " rows="3" style="resize: vertical;"></textarea>
              <label class="input-label">Descripción de perfil</label>
            </div>

            <!-- Campos para redes sociales en el panel de edición -->
            <div class="input-group-modern">
              <input id="editInstagram" type="text" class="input-modern" placeholder=" ">
              <label class="input-label">Usuario de Instagram</label>
            </div>

            <button id="guardarInstagramBtn" class="btn-modern btn-primary-modern">
              <span>📷</span> Guardar Instagram
            </button>

            <div class="input-group-modern">
              <input id="editTwitter" type="text" class="input-modern" placeholder=" ">
              <label class="input-label">Usuario de Twitter</label>
            </div>

            <button id="guardarTwitterBtn" class="btn-modern btn-primary-modern">
              <span>🐦</span> Guardar Twitter
            </button>

            <!-- Avatar Upload Moderno -->
            <div class="upload-modern" onclick="document.getElementById('avatar').click()">
              <div class="upload-icon">📁</div>
              <div class="upload-text">Haz clic o arrastra una imagen para avatar</div>
              <div class="upload-subtext">PNG, JPG hasta 5MB</div>
              <input id="avatar" type="file" accept="image/*" style="display: none;">
            </div>
            <div class="upload-actions">
              <button id="subir-avatar" class="btn-modern btn-small-modern btn-primary-modern">
                <span>⬆️</span> Subir avatar
              </button>
            </div>

            <!-- Cover Upload Moderno -->
            <div class="upload-modern" onclick="document.getElementById('cover').click()" style="margin-top: 20px;">
              <div class="upload-icon">🖼️</div>
              <div class="upload-text">Haz clic o arrastra una imagen para portada</div>
              <div class="upload-subtext">PNG, JPG hasta 5MB</div>
              <input id="cover" type="file" accept="image/*" style="display: none;">
            </div>
            <div class="upload-actions">
              <button id="subir-cover" class="btn-modern btn-small-modern btn-primary-modern">
                <span>⬆️</span> Subir portada
              </button>
            </div>

            <!-- AÑADIR ESTO: Botón para guardar bio -->
            <button id="guardarBioBtn" class="btn-modern btn-primary-modern" style="margin-top: 20px;">
              <span>💾</span> Guardar Descripción
            </button>

            <!-- BOTÓN DE CANCELAR - AÑADIDO AQUÍ -->
            <button id="cancelEditBtn" class="btn-modern btn-outline-modern" style="margin-top: 20px; background: #6c757d; border-color: #6c757d; color: white;">
              <span>↩️</span> Cancelar Edición
            </button>
          </div>
        </div>
      </div>
    </aside>

    <!-- Chat central - SIEMPRE VISIBLE -->
    <main class="chat-panel">
      <div id="chat"></div>
      
      <div class="comment-form">
        <textarea id="mensaje" style="border-radius:30px" maxlength="200" placeholder="Escribe un mensaje..."></textarea>
        <div class="comment-footer">
          <span id="charCount">0/200</span>
          <button id="enviar" class="send-btn">➤</button>
        </div>
      </div>
    </main>

    <!-- Sidebar derecha: lista de usuarios e inspector -->
    <aside class="sidebar-right sidebar">
      <div class="tabs">
        <button class="tab-btn active" data-tab="users">Usuarios</button>
        <button class="tab-btn" data-tab="profile">Perfil</button>
      </div>

      <!-- Lista de usuarios -->
      <div id="users-tab" class="tab-content active">
        <h3>Usuarios conectados</h3>
        <ul id="userList"></ul>
      </div>

      <!-- Inspector de perfil -->
      <div id="profile-tab" class="tab-content">
        <div id="profile-inspector">
          <div class="inspector-header">
            <h3>Perfil de <span id="inspector-header-username">Usuario</span></h3>
            <button id="close-inspector" class="close-btn">×</button>
          </div>
          
          <div class="inspector-cover">
            <img id="inspector-cover" src="assets/default-cover.png" alt="Portada">
          </div>
          
          <div class="inspector-avatar">
            <img id="inspector-avatar" src="assets/default-avatar.png" alt="Avatar">
          </div>
          
          <div class="inspector-info">
            <p><strong>Email:</strong> <span id="inspector-email">email@ejemplo.com</span></p>
            <p><strong>Mensajes enviados:</strong> <span id="inspector-messages">0</span></p>
            <!-- Nombre del usuario debajo del avatar -->
            <h3 id="inspector-displayname" style="text-align: center; margin: 15px 0 10px 0; color: #2c3e50;">Usuario</h3>
            <!-- Descripción sin etiqueta -->
            <p id="inspector-bio" style="text-align: center; font-style: italic; color: #6c757d; margin: 0 0 15px 0;">Bienvenido a EcoChat</p>
            <p><span id="inspector-lastseen">Ahora</span></p>
            <!-- Redes sociales en el inspector de perfil -->
            <div id="inspector-social-links">
              <div id="inspector-instagram-link" class="social-link hidden">
                <span style="font-weight: bold;">📷</span>
                <a id="inspector-instagram-username" href="#" target="_blank" style="color: #6c757d; text-decoration: none; font-weight: bold;">@usuario</a>
              </div>
              <div id="inspector-twitter-link" class="social-link hidden">
                <span style="font-weight: bold;">🐦</span>
                <a id="inspector-twitter-username" href="#" target="_blank" style="color: #6c757d; text-decoration: none; font-weight: bold;">@usuario</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </aside>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="script.js"></script>
</body>
</html>